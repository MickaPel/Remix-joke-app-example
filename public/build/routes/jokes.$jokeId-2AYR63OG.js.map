{
  "version": 3,
  "sources": ["../../../app/routes/jokes.$jokeId.tsx"],
  "sourcesContent": ["// REMIX HMR BEGIN\nif (!window.$RefreshReg$ || !window.$RefreshSig$ || !window.$RefreshRuntime$) {\n  console.warn('remix:hmr: React Fast Refresh only works when the Remix compiler is running in development mode.');\n} else {\n  var prevRefreshReg = window.$RefreshReg$;\n  var prevRefreshSig = window.$RefreshSig$;\n  window.$RefreshReg$ = (type, id) => {\n    window.$RefreshRuntime$.register(type, \"\\\"app\\\\\\\\routes\\\\\\\\jokes.$jokeId.tsx\\\"\" + id);\n  }\n  window.$RefreshSig$ = window.$RefreshRuntime$.createSignatureFunctionForTransform;\n}\nvar _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport * as __hmr__ from \"remix:hmr\";\nif (import.meta) {\n  import.meta.hot = __hmr__.createHotContext(\n  //@ts-expect-error\n  \"app\\\\routes\\\\jokes.$jokeId.tsx\");\n  import.meta.hot.lastModified = \"1694686935954.6277\";\n}\n// REMIX HMR END\n\nimport { json, redirect } from \"@remix-run/node\";\nimport { Form, Link, isRouteErrorResponse, useLoaderData, useParams, useRouteError } from \"@remix-run/react\";\nimport { db } from \"~/utils/db.server\";\nimport { getUserId, requireUserId } from \"~/utils/session.server\";\nexport const meta = ({\n  data\n}) => {\n  const {\n    description,\n    title\n  } = data ? {\n    description: `Enjoy the \"${data.joke.name}\" joke`,\n    title: `${data.joke.name}`\n  } : {\n    description: 'joke not found',\n    title: 'no joke'\n  };\n  return [{\n    title: title\n  }, {\n    name: \"description\",\n    content: description\n  }];\n};\nexport const loader = async ({\n  params,\n  request\n}) => {\n  const userId = await getUserId(request);\n  const joke = await db.joke.findUnique({\n    where: {\n      id: params.jokeId\n    }\n  });\n  if (!joke) {\n    throw new Response(\"Joke not found\", {\n      status: 404\n    });\n  }\n  return json({\n    isOwner: userId === joke.jokesterId,\n    joke\n  });\n};\nexport const action = async ({\n  params,\n  request\n}) => {\n  const form = await request.formData();\n  if (form.get(\"intent\") !== \"delete\") {\n    throw new Response(`The intent ${form.get(\"intent\")} is not supported`, {\n      status: 400\n    });\n  }\n  const userId = await requireUserId(request);\n  const joke = await db.joke.findUnique({\n    where: {\n      id: params.jokeId\n    }\n  });\n  if (!joke) {\n    throw new Response(\"Can't delete what does not exist\", {\n      status: 404\n    });\n  }\n  if (joke.jokesterId !== userId) {\n    throw new Response(\"Pssh, nice try. That's not your joke\", {\n      status: 403\n    });\n  }\n  await db.joke.delete({\n    where: {\n      id: params.jokeId\n    }\n  });\n  return redirect(\"/jokes\");\n};\nexport default function Joke() {\n  _s();\n  const data = useLoaderData();\n  return <div>\r\n            <p>Here's your hilarious joke:</p>\r\n            <p>{data.joke.content}</p>\r\n            <Link to=\".\">\"{data.joke.name}\" Permalink</Link>\r\n            {data.isOwner ? <Form method=\"post\">\r\n                    <button name=\"intent\" type=\"submit\" value=\"delete\" className=\"button\">\r\n                        Delete\r\n                    </button>\r\n                </Form> : null}\r\n        </div>;\n}\n_s(Joke, \"5thj+e1edPyRpKif1JmVRC6KArE=\", false, function () {\n  return [useLoaderData];\n});\n_c = Joke;\nexport function ErrorBoundary() {\n  _s2();\n  const {\n    jokeId\n  } = useParams();\n  const error = useRouteError();\n  if (isRouteErrorResponse(error)) {\n    if (error.status === 400) {\n      return <div className=\"error-container\">\r\n              What you're trying to do is not allowed.\r\n            </div>;\n    }\n    if (error.status === 403) {\n      return <div className=\"error-container\">\r\n              Sorry, but \"{jokeId}\" is not your joke.\r\n            </div>;\n    }\n    if (error.status === 404) {\n      return <div className=\"error-container\">\r\n              Huh? What the heck is \"{jokeId}\"?\r\n            </div>;\n    }\n  }\n  return <div className=\"error-container\">\r\n        There was an error loading joke by the id \"${jokeId}\".\r\n        Sorry.\r\n      </div>;\n}\n_s2(ErrorBoundary, \"+iRNFCBXk6qIZn1G6717fjvaDsM=\", false, function () {\n  return [useParams, useRouteError];\n});\n_c2 = ErrorBoundary;\nvar _c, _c2;\n$RefreshReg$(_c, \"Joke\");\n$RefreshReg$(_c2, \"ErrorBoundary\");\n\nwindow.$RefreshReg$ = prevRefreshReg;\nwindow.$RefreshSig$ = prevRefreshSig;"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsBA,kBAA+B;AAE/B,gBAAmB;AACnB,qBAAyC;AA8E7B;AAtGZ,IAAI,CAAC,OAAO,gBAAgB,CAAC,OAAO,gBAAgB,CAAC,OAAO,kBAAkB;AAC5E,UAAQ,KAAK,kGAAkG;AACjH,OAAO;AACD,mBAAiB,OAAO;AACxB,mBAAiB,OAAO;AAC5B,SAAO,eAAe,CAAC,MAAM,OAAO;AAClC,WAAO,iBAAiB,SAAS,MAAM,yCAA2C,EAAE;AAAA,EACtF;AACA,SAAO,eAAe,OAAO,iBAAiB;AAChD;AANM;AACA;AAMN,IAAI,KAAK,aAAa;AAAtB,IACE,MAAM,aAAa;AAErB,IAAI,aAAa;AACf,cAAY,MAAc;AAAA;AAAA,IAE1B;AAAA,EAAgC;AAChC,cAAY,IAAI,eAAe;AACjC;AAOO,IAAM,OAAO,CAAC;AAAA,EACnB;AACF,MAAM;AACJ,QAAM;AAAA,IACJ;AAAA,IACA;AAAA,EACF,IAAI,OAAO;AAAA,IACT,aAAa,cAAc,KAAK,KAAK;AAAA,IACrC,OAAO,GAAG,KAAK,KAAK;AAAA,EACtB,IAAI;AAAA,IACF,aAAa;AAAA,IACb,OAAO;AAAA,EACT;AACA,SAAO,CAAC;AAAA,IACN;AAAA,EACF,GAAG;AAAA,IACD,MAAM;AAAA,IACN,SAAS;AAAA,EACX,CAAC;AACH;AAsDe,SAAR,OAAwB;AAC7B,KAAG;AACH,QAAM,OAAO,cAAc;AAC3B,SAAO,mDAAC,SACE;AAAA,uDAAC,OAAE,2CAAH;AAAA;AAAA;AAAA;AAAA,WAA8B;AAAA,IAC9B,mDAAC,OAAG,eAAK,KAAK,WAAd;AAAA;AAAA;AAAA;AAAA,WAAsB;AAAA,IACtB,mDAAC,QAAK,IAAG,KAAI;AAAA;AAAA,MAAE,KAAK,KAAK;AAAA,MAAK;AAAA,SAA9B;AAAA;AAAA;AAAA;AAAA,WAAyC;AAAA,IACxC,KAAK,UAAU,mDAAC,QAAK,QAAO,QACrB,6DAAC,YAAO,MAAK,UAAS,MAAK,UAAS,OAAM,UAAS,WAAU,UAAS,sBAAtE;AAAA;AAAA;AAAA;AAAA,WAEA,KAHQ;AAAA;AAAA;AAAA;AAAA,WAIZ,IAAU;AAAA,OARjB;AAAA;AAAA;AAAA;AAAA,SASD;AACR;AACA,GAAG,MAAM,gCAAgC,OAAO,WAAY;AAC1D,SAAO,CAAC,aAAa;AACvB,CAAC;AACD,KAAK;AACE,SAAS,gBAAgB;AAC9B,MAAI;AACJ,QAAM;AAAA,IACJ;AAAA,EACF,IAAI,UAAU;AACd,QAAM,QAAQ,cAAc;AAC5B,MAAI,qBAAqB,KAAK,GAAG;AAC/B,QAAI,MAAM,WAAW,KAAK;AACxB,aAAO,mDAAC,SAAI,WAAU,mBAAkB,wDAAjC;AAAA;AAAA;AAAA;AAAA,aAED;AAAA,IACR;AACA,QAAI,MAAM,WAAW,KAAK;AACxB,aAAO,mDAAC,SAAI,WAAU,mBAAkB;AAAA;AAAA,QACnB;AAAA,QAAO;AAAA,WADrB;AAAA;AAAA;AAAA;AAAA,aAED;AAAA,IACR;AACA,QAAI,MAAM,WAAW,KAAK;AACxB,aAAO,mDAAC,SAAI,WAAU,mBAAkB;AAAA;AAAA,QACR;AAAA,QAAO;AAAA,WADhC;AAAA;AAAA;AAAA;AAAA,aAED;AAAA,IACR;AAAA,EACF;AACA,SAAO,mDAAC,SAAI,WAAU,mBAAkB;AAAA;AAAA,IACW;AAAA,IAAO;AAAA,OADnD;AAAA;AAAA;AAAA;AAAA,SAGH;AACN;AACA,IAAI,eAAe,gCAAgC,OAAO,WAAY;AACpE,SAAO,CAAC,WAAW,aAAa;AAClC,CAAC;AACD,MAAM;AACN,IAAI;AAAJ,IAAQ;AACR,aAAa,IAAI,MAAM;AACvB,aAAa,KAAK,eAAe;AAEjC,OAAO,eAAe;AACtB,OAAO,eAAe;",
  "names": []
}
